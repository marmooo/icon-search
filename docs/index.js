function loadConfig(){localStorage.getItem("darkMode")==1&&(document.documentElement.dataset.theme="dark")}function toggleDarkMode(){localStorage.getItem("darkMode")==1?(localStorage.setItem("darkMode",0),delete document.documentElement.dataset.theme):(localStorage.setItem("darkMode",1),document.documentElement.dataset.theme="dark")}function initSuggest(a){const b=document.getElementById("tags");a.forEach(a=>{tags.set(a,!0);const c=document.createElement("option");c.textContent=a,b.appendChild(c)})}function initCollections(){fetch("/icon-db/collections.json").then(a=>a.json()).then(a=>{a.forEach(a=>{collections.set(a.name,a),delete a.name})})}function initTags(){fetch("/icon-db/tags.json").then(a=>a.json()).then(a=>initSuggest(a))}function showIconDetails(c,b){const d=b[1],e=b[2];showIconSetDetails(d,e);const a=c.cloneNode(!0);a.removeAttribute("role"),a.removeAttribute("data-bs-toggle"),a.removeAttribute("data-bs-target"),a.removeAttribute("aria-controls"),a.setAttribute("width",128),a.setAttribute("height",128),a.onclick=null;const f=document.getElementById("selectedIcon");f.firstChild.replaceWith(a)}function showIconSetDetails(c,b){const a=collections.get(b);document.getElementById("iconTags").textContent=c,document.getElementById("name").textContent=b,document.getElementById("name").href=a.homepage,document.getElementById("license").textContent=a.license,document.getElementById("license").href=a.licenseUrl,document.getElementById("author").textContent=a.author}function showIcon(b,c,d){const e=d.parseFromString(b[0],"image/svg+xml");b[0]=null;const a=e.documentElement;return a.setAttribute("width",c),a.setAttribute("height",c),a.setAttribute("role","button"),a.setAttribute("data-bs-toggle","offcanvas"),a.setAttribute("data-bs-target","#details"),a.setAttribute("aria-controls","details"),a.onclick=()=>{showIconDetails(a,b)},a}function fetchIcons(a){if(tags.has(a)===!1){document.getElementById("noTags").classList.remove("invisible");return}document.getElementById("noTags").classList.add("invisible");const d=document.getElementById("previewSize").value.split("x")[0],b=document.getElementById("result"),c=document.createElement("div");return b.replaceChild(c,b.firstChild),fetch(`/icon-db/json/${a}.json`).then(a=>a.json()).then(a=>{const b=new DOMParser,e=a.map(a=>new Promise(f=>{const e=showIcon(a,d,b);c.appendChild(e),uniqIds(e)}));return Promise.all(e)})}function uniqIds(a){a.querySelectorAll("[id]").forEach(c=>{const d=c.id,b=Math.random().toString(16).slice(2),e=new RegExp(`url\\(#${d}\\);?`,"g");c.id=b,[...a.getElementsByTagName("*")].forEach(a=>{[...a.attributes].forEach(f=>{const c=f.name,d=f.value;if(c=="xlink:href"&&d.startsWith("#"))a.setAttribute(c,`#${b}`);else{const f=d.replace(e,`url(#${b});`);d!=f&&a.setAttribute(c,f)}})})})}function search(){const a=document.getElementById("searchText"),b=a.value.split(" ")[0];a.blur(),a.focus(),fetchIcons(b)}loadConfig();const tags=new Map,collections=new Map;initTags(),initCollections(),new bootstrap.Offcanvas(document.getElementById("details")),document.getElementById("toggleDarkMode").onclick=toggleDarkMode,document.getElementById("search").onclick=search,document.getElementById("searchText").onkeydown=a=>{a.key=="Enter"&&search()},document.getElementById("previewSize").onchange=b=>{const a=b.target.value.split("x")[0],c=document.getElementById("result");[...c.firstChild.children].forEach(b=>{b.setAttribute("width",a),b.setAttribute("height",a)})}